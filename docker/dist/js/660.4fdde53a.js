"use strict";(self["webpackChunkBaoyan_video"]=self["webpackChunkBaoyan_video"]||[]).push([[660],{2024:function(e,t,a){function n(e){if(null==e||""==e)return"";const t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,s=t.getDate()<10?"0"+t.getDate():t.getDate();return a+"-"+n+"-"+s}function s(e){if(null==e||""==e)return"";const t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,s=t.getDate()<10?"0"+t.getDate():t.getDate(),o=t.getHours()<10?"0"+t.getHours():t.getHours(),l=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),u=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return a+"-"+n+"-"+s+" "+o+":"+l+":"+u}function o(e){let t=null;const a=()=>{t&&clearTimeout(t),t=setTimeout((function(){e.value=!0}),1500)},n=()=>{t&&clearTimeout(t),clearTimeout(Number(t)),e.value=!1},s=()=>{t&&clearTimeout(t),e.value=!1};return{vMouseenter:a,vMouseleave:n,visibleClick:s}}a.d(t,{oy:function(){return n},p6:function(){return s},ZP:function(){return o}})},8628:function(e,t,a){a.d(t,{Z:function(){return S}});var n=a(6252),s=a(3577);const o=e=>((0,n.dD)("data-v-1535beed"),e=e(),(0,n.Cn)(),e),l={class:"comment"},u={class:"comment-title"},i=o((()=>(0,n._)("span",null,"评论",-1))),r={class:"comment-desc"},c=(0,n.Uk)("发表评论"),d={class:"popular"},p={class:"popular-msg"},m={class:"name"},v={class:"time"},f={class:"content"};function g(e,t,a,o,g,w){const y=(0,n.up)("el-input"),_=(0,n.up)("el-button"),h=(0,n.up)("el-image");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",l,[(0,n._)("h2",u,[i,(0,n._)("span",r,"共 "+(0,s.zw)(e.commentList.length)+" 条评论",1)]),(0,n.Wm)(y,{class:"comment-input",type:"textarea",placeholder:"期待您的精彩评论...",rows:2,modelValue:e.textarea,"onUpdate:modelValue":t[0]||(t[0]=t=>e.textarea=t)},null,8,["modelValue"]),(0,n.Wm)(_,{class:"sub-btn",type:"primary",onClick:t[1]||(t[1]=t=>e.submitComment())},{default:(0,n.w5)((()=>[c])),_:1})]),(0,n._)("ul",d,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.commentList,((t,a)=>((0,n.wg)(),(0,n.iD)("li",{key:a},[(0,n.Wm)(h,{class:"popular-img",fit:"contain",src:e.getImageUrl(t.avatar)},null,8,["src"]),(0,n._)("div",p,[(0,n._)("ul",null,[(0,n._)("li",m,(0,s.zw)(t.username),1),(0,n._)("li",v,(0,s.zw)(e.formatDate(t.CreatedAt)),1),(0,n._)("li",f,(0,s.zw)(t.content),1)])])])))),128))])],64)}var w=a(2262),y=a(8637),_=a(8045),h=a(2167),b=a(1588),I=a(2024),x=(0,n.aZ)({components:{},props:{playId:String||Number,type:Number},setup(e){const{proxy:t}=(0,n.FN)(),a=(0,y.oR)(),{checkStatus:s,getImageUrl:o}=(0,_.Z)(),{playId:l,type:u}=(0,w.BK)(e),i=(0,w.iH)([]),r=(0,w.iH)(""),c=(0,w.qj)({Support:b.JO.Support}),d=(0,n.Fl)((()=>a.getters.userId));async function p(){try{const e=await h.x.getAllComment(u.value,l.value);i.value=e.data,null!==e.data&&0!==e.data.length||(i.value=[]);for(let t=0;t<i.value.length;t++){const e=await h.x.getUserOfId(i.value[t].userId);i.value[t].avatar=e.data.avatar,i.value[t].username=e.data.username}}catch(e){console.error(e)}}async function m(){if(!s())return;const e=new URLSearchParams;1===u.value?e.append("courseId",`${l.value}`):0===u.value&&e.append("videoId",`${l.value}`),e.append("userId",d.value),e.append("type",`${u.value}`),e.append("content",r.value);const a=await h.x.setComment(e);t.$message({message:a.message,type:a.type}),a.success&&(r.value="",await p())}async function v(e,a){const n=await h.x.deleteComment(e);t.$message({message:n.message,type:n.type}),n.success&&i.value.splice(a,1)}async function f(e,t,a){if(!s())return;const n=new URLSearchParams;n.append("id",e),n.append("up",t+1);const o=await h.x.setSupport(n);o.success&&await p()}return(0,n.YP)(l,(()=>{p()})),(0,n.bv)((()=>{p()})),{userId:d,commentList:i,textarea:r,iconList:c,attachImageUrl:h.x.attachImageUrl,submitComment:m,setSupport:f,formatDate:I.p6,deleteComment:v,getImageUrl:o}}}),k=a(3744);const C=(0,k.Z)(x,[["render",g],["__scopeId","data-v-1535beed"]]);var S=C},5660:function(e,t,a){a.r(t),a.d(t,{default:function(){return x}});var n=a(6252),s=a(3577);const o=e=>((0,n.dD)("data-v-748e5435"),e=e(),(0,n.Cn)(),e),l={class:"video-info-header"},u={class:"video-info-course-title"},i={class:"video-info-status"},r={class:"video-info-video-title"},c={class:"video-info-content"},d=o((()=>(0,n._)("h1",null,"课程列表",-1)));function p(e,t,a,o,p,m){const v=(0,n.up)("video-player"),f=(0,n.up)("el-card"),g=(0,n.up)("el-aside"),w=(0,n.up)("el-tooltip"),y=(0,n.up)("el-menu-item"),_=(0,n.up)("el-menu"),h=(0,n.up)("el-scrollbar"),b=(0,n.up)("comment"),I=(0,n.up)("el-main"),x=(0,n.up)("el-container");return(0,n.wg)(),(0,n.j4)(x,null,{default:(0,n.w5)((()=>[(0,n.Wm)(g,{class:"video-slide",width:"970px"},{default:(0,n.w5)((()=>[(0,n.Wm)(v,{ref:"videoPlayer",class:"video-player-box",options:e.options.playerOptions},null,8,["options"]),(0,n.Wm)(f,{class:"video-info",shadow:"never","body-style":"padding:0"},{default:(0,n.w5)((()=>[(0,n._)("div",l,[(0,n._)("span",u,(0,s.zw)(e.courseDetail.title),1),(0,n._)("span",i,(0,s.zw)(e.getCourseStatus(e.courseDetail.status)),1)]),(0,n._)("div",r," 标题："+(0,s.zw)(e.currentVideo.title),1),(0,n._)("div",c,"简介："+(0,s.zw)(e.getIntroduction(e.currentVideo.introduction)),1)])),_:1})])),_:1}),(0,n.Wm)(I,{class:"video-main"},{default:(0,n.w5)((()=>[(0,n.Wm)(f,{class:"video-main-card"},{default:(0,n.w5)((()=>[d,(0,n.Wm)(h,{class:"scrollbar",ref:"scrollbarRef","max-height":"20rem"},{default:(0,n.w5)((()=>[(0,n.Wm)(_,{ref:"box",class:"course-menu",onSelect:e.handleSelect},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.currentVideoList,((a,o)=>((0,n.wg)(),(0,n.j4)(y,{ref_for:!0,ref:"subbox",key:o,class:(0,s.C_)({"is-active":a.id==e.videoId}),index:o+""},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{class:"box-item",effect:"dark",content:a.title,placement:"bottom-end"},{default:(0,n.w5)((()=>[(0,n._)("div",{class:"menu-box",onMouseenter:t[0]||(t[0]=t=>e.vMouseenter()),onMouseleave:t[1]||(t[1]=t=>e.vMouseleave()),ref_for:!0,ref:"filledRef",onClick:t[2]||(t[2]=t=>e.visibleClick())},(0,s.zw)(a.title),545)])),_:2},1032,["content"])])),_:2},1032,["class","index"])))),128))])),_:1},8,["onSelect"])])),_:1},512)])),_:1}),(0,n.Wm)(b,{playId:e.videoId+"",type:0},null,8,["playId"])])),_:1})])),_:1})}var m=a(2262),v=a(8637),f=a(8045),g=a(8628),w=a(2167),y=a(2119),_=a(2024),h=(0,n.aZ)({components:{Comment:g.Z},setup(){const{proxy:e}=(0,n.FN)(),t=(0,v.oR)(),{checkStatus:a,getCourseStatus:s,getIntroduction:o}=(0,f.Z)(),l=(0,y.tv)(),u=(0,m.iH)(""),i=(0,m.iH)(l.currentRoute.value.params.id),r=(0,m.iH)([]),c=(0,m.iH)({}),d=(0,m.iH)(0),p=(0,m.iH)(0),g=(0,m.iH)(!1),h=(0,m.iH)("评价"),b=(0,n.Fl)((()=>t.getters.userId)),I=(0,m.iH)("video"),{routerManager:x}=(0,f.Z)(),k=(0,m.iH)(""),C=(0,m.iH)({}),S=(0,m.iH)(null),D=(0,m.iH)(!1),{vMouseenter:H,vMouseleave:M,visibleClick:R}=(0,_.ZP)(D);u.value=i.value;let V=(0,m.qj)({playerOptions:{playbackRates:[.5,1,1.5,2],autoplay:!1,muted:!1,loop:!1,preload:"auto",language:"zh-CN",fluid:!0,sources:[{type:"video/mp4",src:"https://vd3.bdstatic.com/mda-maunc8q8gpwgjts8/sc/cae_h264_nowatermark/1611907885/mda-maunc8q8gpwgjts8.mp4?v_from_s=hkapp-haokan-hbf&auth_key=1660703434-0-0-645160ca4ccdbc9c0c2088e7d56dd8b9&bcevod_channel=searchbox_feed&pd=1&cd=0&pt=3&logid=0034644783&vid=11220038343555649881&abtest=103890_1-103579_2&klogid=0034644783"}],notSupportedMessage:"此视频暂无法播放，请稍后再试",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}}});function U(t){t<5||(5===t?e.$refs["scrollbarRef"].setScrollTop(32):e.$refs["scrollbarRef"].setScrollTop(56*(t-5)+32))}async function W(e){const t=await w.x.getCourseAndVideosOfVideoId(e);c.value=t.data.course,r.value=t.data.videos,r.value.forEach((function(t,a){t.title=t.title.trim(),t.id==e&&(k.value=a,C.value=t)}))}async function Z(e){const t=await w.x.getVideoURLOfId(e);V.playerOptions.sources[0].src=t.data.url;const a=await w.x.getVideoOfId(e);C.value=a.data}async function z(){if(g.value||!a())return;const t=new URLSearchParams;t.append("consumerId",b.value),t.append("score",(2*d.value).toString());try{const a=await w.x.setRank(t);e.$message({message:a.message,type:a.type}),a.success&&(g.value=!0,h.value="已评价")}catch(n){console.error(n)}}function L(e){const t=r.value[e].id;u.value=t,x(I.value,{path:`/${I.value}/${t}`})}return(0,n.bv)((()=>{W(u.value),Z(u.value)})),(0,n.YP)([u,k],(([e,t],[a,s])=>{e!==a&&Z(u.value),""===s&&t!==s&&(0,n.Y3)((()=>{U(t)}))})),{currentVideo:C,videoId:u,options:V,courseDetail:c,rank:p,score:d,disabledRank:g,assistText:h,currentVideoList:r,pushValue:z,handleSelect:L,getCourseStatus:s,getIntroduction:o,filledRef:S,visible:D,vMouseenter:H,vMouseleave:M,visibleClick:R}}}),b=a(3744);const I=(0,b.Z)(h,[["render",p],["__scopeId","data-v-748e5435"]]);var x=I}}]);
//# sourceMappingURL=660.4fdde53a.js.map