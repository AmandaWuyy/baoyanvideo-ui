"use strict";(self["webpackChunkBaoyan_video"]=self["webpackChunkBaoyan_video"]||[]).push([[0,875],{1875:function(e,a,o){o.r(a),o.d(a,{default:function(){return _}});var l=o(3396);const r=(0,l.Uk)("女"),t=(0,l.Uk)("男"),n=(0,l.Uk)("Not listed"),s=(0,l.Uk)("取消"),d=(0,l.Uk)("保存");function u(e,a,o,u,m,i){const p=(0,l.up)("el-input"),c=(0,l.up)("el-form-item"),w=(0,l.up)("el-radio"),f=(0,l.up)("el-radio-group"),g=(0,l.up)("el-option"),b=(0,l.up)("el-select"),_=(0,l.up)("el-button"),W=(0,l.up)("el-form");return(0,l.wg)(),(0,l.j4)(W,{ref:"updateForm","label-width":"70px",model:e.registerForm,rules:e.SignUpRules},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{prop:"username",label:"用户名"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{disabled:"",modelValue:e.registerForm.username,"onUpdate:modelValue":a[0]||(a[0]=a=>e.registerForm.username=a),placeholder:"用户名"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(c,{label:"性别"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:e.registerForm.gender,"onUpdate:modelValue":a[1]||(a[1]=a=>e.registerForm.gender=a)},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{label:2},{default:(0,l.w5)((()=>[r])),_:1}),(0,l.Wm)(w,{label:1},{default:(0,l.w5)((()=>[t])),_:1}),(0,l.Wm)(w,{label:0},{default:(0,l.w5)((()=>[n])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(c,{prop:"introduction",label:"签名"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{type:"textarea",placeholder:"签名",modelValue:e.registerForm.introduction,"onUpdate:modelValue":a[2]||(a[2]=a=>e.registerForm.introduction=a)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(c,{prop:"location",label:"地区"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{modelValue:e.registerForm.location,"onUpdate:modelValue":a[3]||(a[3]=a=>e.registerForm.location=a),placeholder:"地区",style:{width:"100%"}},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.AREA,(e=>((0,l.wg)(),(0,l.j4)(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(c,{prop:"phoneNum",label:"手机"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"手机",modelValue:e.registerForm.phoneNum,"onUpdate:modelValue":a[4]||(a[4]=a=>e.registerForm.phoneNum=a)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(c,{prop:"email",label:"邮箱"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:e.registerForm.email,"onUpdate:modelValue":a[5]||(a[5]=a=>e.registerForm.email=a),placeholder:"邮箱"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{onClick:a[6]||(a[6]=a=>e.goBack(-1))},{default:(0,l.w5)((()=>[s])),_:1}),(0,l.Wm)(_,{type:"primary",onClick:a[7]||(a[7]=a=>e.saveMsg())},{default:(0,l.w5)((()=>[d])),_:1})])),_:1})])),_:1},8,["model","rules"])}var m=o(4870),i=o(9749),p=o(8045),c=o(1588),w=o(2167),f=(0,l.aZ)({setup(){const{proxy:e}=(0,l.FN)(),a=(0,i.oR)(),{goBack:o}=(0,p.Z)(),r=(0,m.qj)({username:"",gender:"",phoneNum:"",email:"",introduction:"",location:"",userPic:""}),t=(0,l.Fl)((()=>a.getters.userId));async function n(e){const a=await w.x.getUserOfId(e);r.username=a.data.username,r.gender=a.data.gender,r.phoneNum=a.data.phoneNum,r.email=a.data.email,r.introduction=a.data.introduction,r.location=a.data.location,r.userPic=a.data.avatar}async function s(){let a=!0;if(e.$refs["updateForm"].validate((e=>{if(!e)return a=!1})),!a)return;const l=new URLSearchParams;l.append("id",t.value),l.append("username",r.username),l.append("gender",r.gender),l.append("phone_num",r.phoneNum),l.append("email",r.email),l.append("introduction",r.introduction),l.append("location",r.location);const n=await w.x.updateUserDetail(l);e.$message({message:n.message,type:n.type}),n.success&&(e.$store.commit("setUsername",r.username),o(-1))}return(0,l.bv)((()=>{n(t.value)})),{AREA:c.q1,registerForm:r,SignUpRules:c._P,saveMsg:s,goBack:o}}}),g=o(89);const b=(0,g.Z)(f,[["render",u],["__scopeId","data-v-7456ef0b"]]);var _=b},2e3:function(e,a,o){o.r(a),o.d(a,{default:function(){return F}});var l=o(3396);const r=e=>((0,l.dD)("data-v-b8db52b0"),e=e(),(0,l.Cn)(),e),t={class:"setting"},n=r((()=>(0,l._)("h1",null,"设置",-1))),s=(0,l.Uk)("注销账号");function d(e,a,o,r,d,u){const m=(0,l.up)("Personal-data"),i=(0,l.up)("el-tab-pane"),p=(0,l.up)("Password"),c=(0,l.up)("el-button"),w=(0,l.up)("el-tabs");return(0,l.wg)(),(0,l.iD)("div",t,[n,(0,l.Wm)(w,{"tab-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{label:"个人资料",class:"content"},{default:(0,l.w5)((()=>[(0,l.Wm)(m)])),_:1}),(0,l.Wm)(i,{label:"更改密码",class:"content"},{default:(0,l.w5)((()=>[(0,l.Wm)(p)])),_:1}),(0,l.Wm)(i,{label:"注销账号",class:"content"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{type:"danger",icon:e.Delete,onClick:e.cancelAccount},{default:(0,l.w5)((()=>[s])),_:1},8,["icon","onClick"])])),_:1})])),_:1})])}var u=o(547),m=o(1875);const i=(0,l.Uk)("重置"),p=(0,l.Uk)("确认修改");function c(e,a,o,r,t,n){const s=(0,l.up)("el-input"),d=(0,l.up)("el-form-item"),u=(0,l.up)("el-button"),m=(0,l.up)("el-form");return(0,l.wg)(),(0,l.j4)(m,{ref:"passwordForm","label-width":"70px",model:e.form,rules:e.rules},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"旧密码",prop:"oldPassword"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{type:"password",modelValue:e.form.oldPassword,"onUpdate:modelValue":a[0]||(a[0]=a=>e.form.oldPassword=a)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(d,{label:"新密码",prop:"newPassword"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{type:"password",modelValue:e.form.newPassword,"onUpdate:modelValue":a[1]||(a[1]=a=>e.form.newPassword=a)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(d,{label:"密码确认",prop:"confirmPassword"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{type:"password",modelValue:e.form.confirmPassword,"onUpdate:modelValue":a[2]||(a[2]=a=>e.form.confirmPassword=a)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{onClick:a[3]||(a[3]=a=>e.clearData())},{default:(0,l.w5)((()=>[i])),_:1}),(0,l.Wm)(u,{type:"primary",onClick:a[4]||(a[4]=a=>e.confirm())},{default:(0,l.w5)((()=>[p])),_:1})])),_:1})])),_:1},8,["model","rules"])}o(1703);var w=o(4870),f=o(9749),g=o(8045),b=o(2167),_=o(1588),W=(0,l.aZ)({setup(){const e=(0,f.oR)(),{proxy:a}=(0,l.FN)(),{goBack:o}=(0,g.Z)(),r=(0,w.qj)({oldPassword:"",newPassword:"",confirmPassword:""}),t=(0,l.Fl)((()=>e.getters.userId)),n=(0,l.Fl)((()=>e.getters.username)),s=(e,a,o)=>{""===a?o(new Error("密码不能为空")):a!==r.newPassword?o(new Error("请输入正确密码")):o()},d=(0,w.qj)({oldPassword:[{validator:_.uo,trigger:"blur",min:6}],newPassword:[{validator:_.uo,trigger:"blur",min:6}],confirmPassword:[{validator:s,trigger:"blur",min:6}]});function u(){r.oldPassword="",r.newPassword="",r.confirmPassword=""}async function m(){let e=!0;if(a.$refs["passwordForm"].validate((a=>{if(!a)return e=!1})),!e)return;if(r.oldPassword===r.newPassword)return void a.$message({message:"新密码不能与旧密码相同",type:"error"});const l=new URLSearchParams;l.append("id",t.value),l.append("username",n.value),l.append("old_password",r.oldPassword),l.append("new_password",r.newPassword);const s=await b.x.updateUserPassword(l);a.$message({message:s.message,type:s.type}),s.success&&o()}return{form:r,clearData:u,confirm:m,rules:d}}}),v=o(89);const P=(0,v.Z)(W,[["render",c]]);var y=P,V=(0,l.aZ)({components:{PersonalData:m["default"],Password:y},setup(){const{proxy:e}=(0,l.FN)(),a=(0,f.oR)(),{routerManager:o}=(0,g.Z)(),r=(0,l.Fl)((()=>a.getters.userId));async function t(){const a=await b.x.deleteUser(r.value);e.$message({message:a.message,type:a.type}),o(_.wC.SignIn,{path:_.wC.SignIn}),e.$store.commit("setToken",!1)}return{Delete:u.Z,cancelAccount:t}}});const U=(0,v.Z)(V,[["render",d],["__scopeId","data-v-b8db52b0"]]);var F=U}}]);
//# sourceMappingURL=0.c801d09e.js.map